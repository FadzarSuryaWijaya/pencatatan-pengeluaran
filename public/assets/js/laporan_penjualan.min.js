let laporan_penjualan = $("#laporan_penjualan").DataTable({
    responsive: !0,
    scrollX: !0,
    ajax: readUrl,
    columnDefs: [{ searcable: !1, orderable: !1, targets: 0 }],
    order: [[1, "asc"]],
    columns: [
        { data: null },
        { data: "tanggal" },
        { data: "nama_produk" },
        { data: "total_bayar" },
        { data: "jumlah_uang" },
        { data: "diskon" },
        { data: "pelanggan" },
    ],
});
function reloadTable() {
    laporan_penjualan.ajax.reload();
}
function remove(a) {
    Swal.fire({
        title: "Hapus",
        text: "Hapus data ini?",
        type: "warning",
        showCancelButton: !0,
    }).then(() => {
        $.ajax({
            url: deleteUrl,
            type: "post",
            dataType: "json",
            data: { id: a },
            success: () => {
                Swal.fire("Sukses", "Sukses Menghapus Data", "success"), reloadTable();
            },
            error: (a) => {
                console.log(a);
            },
        });
    });
}
laporan_penjualan.on("order.dt search.dt", () => {
    laporan_penjualan
        .column(0, { search: "applied", order: "applied" })
        .nodes()
        .each((a, e) => {
            a.innerHTML = e + 1;
        });
}),
// Initialize Date Range Picker

function reloadTable() {
    laporan_penjualan.ajax.reload();
}

// Sequential numbering for "No" column (DataTables internal logic)
laporan_penjualan.on("order.dt search.dt", () => {
    laporan_penjualan.column(0, {
        search: "applied",
        order: "applied"
    }).nodes().each((a, e) => {
        a.innerHTML = e + 1;
    });
});

// Initialize Date Range Picker
$(function() {
    let start = moment().subtract(29, 'days');
    let end = moment();

    function cb(start, end, label) { // Added 'label' parameter
        if (label === 'Semua Waktu') {
            $('#reportrange span').html('Semua Waktu');
            // Jika 'Semua Waktu' dipilih, kirim parameter kosong
            laporan_penjualan.ajax.url(filterUrl + '?start_date=&end_date=').load();
        } else {
            $('#reportrange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
            // Load data with filter when dates change
            laporan_penjualan.ajax.url(filterUrl + '?start_date=' + start.format('YYYY-MM-DD') + '&end_date=' + end.format('YYYY-MM-DD')).load();
        }
    }

    $('#reportrange').daterangepicker({
        startDate: start,
        endDate: end,
        ranges: {
            'Today': [moment(), moment()],
            'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
            'Last 7 Days': [moment().subtract(6, 'days'), moment()],
            'Last 30 Days': [moment().subtract(29, 'days'), moment()],
            'This Month': [moment().startOf('month'), moment().endOf('month')],
            'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],
            'Semua Waktu': [moment().startOf('year').subtract(100, 'years'), moment().endOf('year').add(100, 'years')] // A very wide range to represent all time
        }
    }, cb);

    // Initial call to set the date range and load data
    cb(start, end, 'Semua Waktu'); // Set default label to 'Last 30 Days'
});
    $(".modal").on("hidden.bs.modal", () => {
        $("#form")[0].reset(), $("#form").validate().resetForm();
    });
